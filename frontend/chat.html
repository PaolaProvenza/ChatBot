<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NovAI!</title>

    <!-- Collegamento al file CSS esterno -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="chat.css">
</head>

<body>
    <div class="chat-background">
        <img src="immagini/Inizio.png" class="img-sfondo-chat">
        <video autoplay muted loop playsinline class="video">
            <source src="video/video.mp4" type="video/mp4">
        </video>
    </div>

    <div class="barra">
        <!--POI AGGIUNGIAMO IL LOGOUT DALLA CHAT-->
        <!--<button id="logoutBtn">Logout</button>-->

        <div class="chat-header">
            <h1 class="titolo">NovAI!</h1>
        </div>

        <div class="logo" id="logo">
            <img src="immagini/Logo.png" class="img-logo">
            <p class="utente"> </p>
        </div>
    </div>

    <div class="frame-chat">
    </div>
</body>

<script>

    fetch("/check-auth")
    .then(res => {
        if (!res.ok) window.location.href = "/";
    });


    logo.onclick = () => {
        console.log("Logo cliccato — qui torni indietro");
        window.location.href = "index.html";
    };

    //COLLEGATO AL BOTTONE DI LOGOUT
    //const logoutBtn = document.getElementById("logoutBtn");

    //logoutBtn.onclick = () => {
    // rimuove l’utente loggato da localStorage
    //localStorage.removeItem("loggedUser");

    //torna alla pagina di login
    //window.location.href = "index.html";
    //};

    window.addEventListener("DOMContentLoaded", () => {
    const nickname = localStorage.getItem("loggedUser");
    const userEl = document.querySelector(".utente");

    if (nickname && userEl) {
        userEl.textContent = nickname;  // <-- mostra il nickname corretto
    } else {
        userEl.textContent = "Utente"; // fallback
    }

    const data = JSON.parse(localStorage.getItem("transMessage"));
    if (data) {
        const messageBox = document.createElement("div");
        messageBox.id = "messageBox";
        messageBox.className = `message-box ${data.type} show`;
        messageBox.textContent = data.text;
        document.body.appendChild(messageBox);

        setTimeout(() => {
            messageBox.className = `message-box ${data.type}`;
        }, 2000);
        localStorage.removeItem("transMessage");
    }
});

</script>
</html>
